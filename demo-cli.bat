@echo off
REM ============================================================================
REM FROST CLI Demo Script - Windows ç‰ˆæœ¬
REM ============================================================================
REM é€™å€‹è…³æœ¬å±•ç¤ºå¦‚ä½•ä½¿ç”¨ frost-cli å·¥å…·å®Œæˆå®Œæ•´çš„ 3-of-5 é–€æª»ç°½ç« æµç¨‹
REM åœ¨å–®ä¸€çµ‚ç«¯è¦–çª—åŸ·è¡Œï¼ˆæ¨¡æ“¬å¤šæ–¹å”ä½œï¼‰
REM ============================================================================

echo.
echo â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
echo â•‘   FROST CLI Demo - 3-of-5 é–€æª»ç°½ç« å®Œæ•´æµç¨‹                    â•‘
echo â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

REM æ¸…ç†èˆŠè³‡æ–™
echo ğŸ§¹ æ¸…ç†èˆŠè³‡æ–™...
if exist frost-data rmdir /s /q frost-data
if exist .frost-nonces rmdir /s /q .frost-nonces
if exist *.json del /q *.json
if exist message.txt del /q message.txt
mkdir frost-data
echo.

REM ============================================================================
REM éšæ®µ 1: é‡‘é‘°ç”Ÿæˆï¼ˆDealerï¼‰
REM ============================================================================
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo éšæ®µ 1: é‡‘é‘°ç”Ÿæˆ (Trusted Dealer)
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

cargo run --bin frost-cli -- keygen --output-dir frost-data --max-signers 5 --min-signers 3

if %errorlevel% neq 0 (
    echo âŒ é‡‘é‘°ç”Ÿæˆå¤±æ•—
    exit /b 1
)

echo.
pause

REM ============================================================================
REM éšæ®µ 2: æº–å‚™è¨Šæ¯
REM ============================================================================
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo éšæ®µ 2: æº–å‚™è¦ç°½ç½²çš„è¨Šæ¯
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

echo Transfer 1.5 BTC to bc1qxy2kgdygjrsqtzq2n0yrf2493p83kkfjhx0wlh (tx: 0xabcd1234) > message.txt
echo âœ“ è¨Šæ¯å·²å¯«å…¥ message.txt
type message.txt
echo.
pause

REM ============================================================================
REM éšæ®µ 3: Round 1 - ç°½ç½²è€… 1, 2, 3 ç”Ÿæˆæ‰¿è«¾
REM ============================================================================
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo éšæ®µ 3: Round 1 - ç”Ÿæˆ Nonce æ‰¿è«¾
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

echo ğŸ“ ç°½ç½²è€… 1 ç”Ÿæˆæ‰¿è«¾...
cargo run --bin frost-cli -- round1 ^
    --share-file frost-data/share_1.json ^
    --message-file message.txt ^
    --output commitment_1.json

if %errorlevel% neq 0 (
    echo âŒ ç°½ç½²è€… 1 Round 1 å¤±æ•—
    exit /b 1
)

echo.
echo ğŸ“ ç°½ç½²è€… 2 ç”Ÿæˆæ‰¿è«¾...
cargo run --bin frost-cli -- round1 ^
    --share-file frost-data/share_2.json ^
    --message-file message.txt ^
    --output commitment_2.json

if %errorlevel% neq 0 (
    echo âŒ ç°½ç½²è€… 2 Round 1 å¤±æ•—
    exit /b 1
)

echo.
echo ğŸ“ ç°½ç½²è€… 3 ç”Ÿæˆæ‰¿è«¾...
cargo run --bin frost-cli -- round1 ^
    --share-file frost-data/share_3.json ^
    --message-file message.txt ^
    --output commitment_3.json

if %errorlevel% neq 0 (
    echo âŒ ç°½ç½²è€… 3 Round 1 å¤±æ•—
    exit /b 1
)

echo.
echo âœ“ æ‰€æœ‰ç°½ç½²è€…å·²å®Œæˆ Round 1
pause

REM ============================================================================
REM éšæ®µ 4: å”èª¿è€…å»ºç«‹ç°½ç« å¥—ä»¶
REM ============================================================================
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo éšæ®µ 4: å”èª¿è€…å»ºç«‹ç°½ç« å¥—ä»¶
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

cargo run --bin frost-cli -- create-package ^
    --commitment-files commitment_1.json commitment_2.json commitment_3.json ^
    --message-file message.txt ^
    --output signing_package.json

if %errorlevel% neq 0 (
    echo âŒ å»ºç«‹ç°½ç« å¥—ä»¶å¤±æ•—
    exit /b 1
)

echo.
pause

REM ============================================================================
REM éšæ®µ 5: Round 2 - ç°½ç½²è€…ç”Ÿæˆç°½ç« åˆ†ç‰‡
REM ============================================================================
echo.
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo éšæ®µ 5: Round 2 - ç”Ÿæˆç°½ç« åˆ†ç‰‡
echo â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
echo.

REM éœ€è¦å¾ commitment æª”æ¡ˆä¸­è®€å– session_id
REM ç‚ºäº†ç°¡åŒ–ï¼Œæˆ‘å€‘å‡è¨­æ‰€æœ‰ commitment ä½¿ç”¨åŒä¸€å€‹ session_id
REM åœ¨å¯¦éš›ä½¿ç”¨ä¸­ï¼Œæ‡‰è©²å¾ JSON æª”æ¡ˆè§£æ

echo ğŸ“ ç°½ç½²è€… 1 ç”Ÿæˆç°½ç« åˆ†ç‰‡...
cargo run --bin frost-cli -- round2 ^
    --share-file frost-data/share_1.json ^
    --package-file signing_package.json ^
    --output sig_share_1.json ^
    --session-id SESSION_ID_PLACEHOLDER

REM Note: ä¸Šé¢çš„æŒ‡ä»¤æœƒå¤±æ•—ï¼Œå› ç‚º session_id éœ€è¦å‹•æ…‹è®€å–
REM é€™æ˜¯ demo è…³æœ¬çš„é™åˆ¶ - åœ¨çœŸå¯¦ä½¿ç”¨ä¸­æ‡‰è©²ï¼š
REM 1. ä½¿ç”¨ jq æˆ– PowerShell è§£æ JSON
REM 2. æˆ–è€…è®“ä½¿ç”¨è€…æ‰‹å‹•åŸ·è¡Œæ¯å€‹å‘½ä»¤

echo.
echo âš ï¸  æ³¨æ„ï¼šæ­¤ demo è…³æœ¬æœ‰é™åˆ¶
echo    åœ¨çœŸå¯¦ä½¿ç”¨ä¸­ï¼Œè«‹åƒè€ƒ CLI-DEMO.md æ‰‹å‹•åŸ·è¡Œæ¯å€‹å‘½ä»¤
echo    æˆ–ä½¿ç”¨ PowerShell ç‰ˆæœ¬çš„è…³æœ¬
echo.

pause
exit /b 0
